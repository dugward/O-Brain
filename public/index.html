<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Metastuff
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <meta
      name="description"
      content="O'Brain is an attempt to teach an AI to write in the style of the great Patrick O'Brian."
    />
    <meta
      property="og:description"
      content="O'Brain is an attempt to teach an AI to write in the style of the great Patrick O'Brian."
    />
    <title>O'Brain</title>
    <meta property="og:site_name" content="O'Brain" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.dugward.com/obrain" />
    <!-- 1200X600 is good -->
    <meta
      property="og:image"
      content="https://www.dugward.com/obrain/thumb.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/img/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/img/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/img/favicon-16x16.png"
    />

    <!-- FONT
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />

    <link rel="stylesheet" href="https://use.typekit.net/dgv7pni.css" />
    <!-- CSS
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
    <link
      href="
  https://cdn.jsdelivr.net/npm/modern-normalize@1.1.0/modern-normalize.min.css
    "
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />

    <!-- the page
  –––––––––––––––––––––––––––––––––––––––––––––––––– -->
  </head>
  <body>
    <!-- header -->

    <header>
      <div class="headerimg">
        <img src="img/ship.png" alt="sailing ship" />
      </div>
      <div class="menuIcons">
        <span id="closemenu" class="material-symbols-sharp close menuicon">
          close
        </span>
        <span id="burgermenu" class="material-symbols-sharp burger menuicon">
          menu
        </span>
      </div>

      <div class="navItem firstNavItem">
        <a href="#samples">Samples</a>
      </div>
      <div class="navItem lastNavItem"><a href="#creation">Creation</a></div>
    </header>

    <!-- main -->
    <main>
      <div class="big-text">
        <span class="highlight" style="font-style: italic">O'Brain</span> is an
        attempt to teach an AI to write in the style of the great Patrick
        O'Brian.
      </div>
      <div class="medium-text">
        Some <a href="#samples">samples</a> of its work are below, read by
        <span class="highlight">tull_ai</span>, an AI narrator inspired by
        Patrick Tull. You can also read about O'Brain's
        <a href="#creation">creation</a>.
      </div>
      <div class="category" id="samples">Samples</div>
      <div class="title">
        1. The Uncommon Palm<span class="material-symbols-sharp expand">
          expand_less
        </span>
      </div>
      <div class="collapse open">
        <div class="quote-text">
          Stephen stood there, eating a grilled fish, watching them intently for
          a while. They were interesting cases &mdash; those whose friends had
          been killed often were &mdash; but now he must look through his other
          observations until he could persuade Babbington to go to bed. 'This is
          a charming place,' he said, looking up at the long, deep-rooted bay
          and the green cliffs, all of them very fine on the horizon, and a
          tall, low-ceilinged palm-tree, some two hundred feet high, almost a
          thousand feet long, with a mass of palms that glowed with a most
          uncommon brilliance in the moonlit sky.
        </div>
        <audio src="audio/palm.mp3" controls></audio>
      </div>
      <div class="title">
        2. A Glass of Old Weevil<span class="material-symbols-sharp expand">
          expand_more
        </span>
      </div>
      <div class="collapse">
        <div class="quote-text">
          'Not that I mean to complain, brother,' said Stephen, gazing at him
          with all his might. 'A glass of Old Weevil will make us fall asleep at
          last. Though at present I do not feel like sleeping. I shall have no
          wakings either. I hope, indeed, that God preserve us, and I do not
          wish to go now without a nightcap and a cloak over my pillow.' As he
          lay there by the taffrail, waiting for Jack to clear his troubled
          mind, he heard a strong rustling on the bowsprit far aft: a sound
          which, as Jack's eyes narrowed in the darkness, he could not make out,
          but which was clearly there, loud and clear, a great way off.
        </div>
        <audio src="audio/way_off.mp3" controls></audio>
      </div>
      <div class="title">
        3. Jack Speaks of His Levity<span class="material-symbols-sharp expand">
          expand_more
        </span>
      </div>
      <div class="collapse">
        <div class="quote-text">
          'She is the sweetest thing,' said Jack, and his face took on a very
          thoughtful cast. 'Even if she were not so very much knocked about in
          debt, I should keep the ring. But in any case, I believe she will
          learn English pretty quick.' A lightning-flash lit up his sea-chest
          and he opened it with a clean handkerchief. 'I am speaking to you
          about my levity,' he said, '. . . on the other hand, many people have
          approached me for groping and even beating and bawling and whistling
          and waving my hat.'
        </div>
        <audio src="audio/waving_hat.mp3" controls></audio>
      </div>
      <div class="title">
        4. Things Get a Little Wet<span class="material-symbols-sharp expand">
          expand_more
        </span>
      </div>
      <div class="collapse">
        <div class="quote-text">
          'He sat there looking at the masthead, which he thought most
          impressive, and which after a moment assumed great importance, as the
          ship was turning south-west at six or seven knots with a gentle breeze
          under the topgallant sails while her people carried on their ordinary
          duties. The foremast had vanished; the lower jibboom, like most of the
          other upper yards, had already been battened down. He sat on the rail
          at his ease, watching the water ripple through the rigging and the
          sails, and as the watch below came on deck, he was surprised to see
          the entire mass of water sweeping in, with every sail out of control.
        </div>
        <audio src="audio/sinking.mp3" controls></audio>
      </div>
      <div class="category" id="creation">Creation</div>

      <div class="title">
        1. The Process<span class="material-symbols-sharp expand">
          expand_less
        </span>
      </div>
      <div class="collapse open">
        <div class="chunk-text">
          O’Brain is a fine-tuned version of
          <a href="https://en.wikipedia.org/wiki/GPT-2">GPT-2</a> that has been
          trained on a dataset of 33,854 paragraphs from the 19 completed novels
          in the Aubrey-Maturin series. It was trained using Hugging Face's
          <a href="https://huggingface.co/docs/transformers/index"
            >transformers library</a
          >
          and PyTorch. You can find the code for the project on the
          <a
            href="https://colab.research.google.com/drive/1aYajxrOjQhVb1CcbzGgxtL_520WehWLK?usp=sharing"
            >Colab notebook</a
          >. If you're interested,

          <span id="moredetailslink"
            >there are more nerdy details.<span
              class="material-symbols-sharp expand"
            >
              expand_more
            </span></span
          >
          <p id="moredetails" class="collapse">
            Though the dataset contains 34k paragraphs, when paragraphs of any
            length were allowed, the model produced mostly unsyntactic highly
            repetitive nonsense. These models did have the best chance of
            producing poetic results, however, including lines such as
            <span class="spanquote"
              >It is a creeping, dew-soaked, dew-soaked moon; and I am not at
              all grieved</span
            >
            or
            <span class="spanquotelong"
              >there was something of a cold, something of an acuity of
              vegetation, something of a cold, something of an absence of rock,
              and the air was almost entirely lost -- and that the breeze had
              more to do with the land.</span
            >
            It was found that trimming the data to paragraphs over 660
            characters produced fairly sensical results. This reduced the data
            to less than 6k examples. Given the complexity of a paragraph of
            O'Brian's prose, 6k examples very quickly led to overfitting. Here,
            we see the results of ten epochs.
            <img src="img/graph1.png" alt="" /><br />
            The best results seemed to come from just two epochs.
            <img src="img/graph2.png" alt="" />
          </p>
        </div>
      </div>
      <div class="title">
        2. Are These Cherrypicked?<span class="material-symbols-sharp expand">
          expand_more
        </span>
      </div>
      <div class="collapse">
        <div class="chunk-text">
          Absolutely! From the best three models, about ten somewhat cohesive
          paragraphs with something like internal logic were found. Most of the
          time, even the better models provided this sort of thing:
        </div>

        <div class="quote-text">
          'I have a most uncommon long-legged and prodigious spleen,' said
          Stephen, gazing at the spleen. 'I had almost always seen it, my dear
          &mdash; the first time I saw a spleen. I was contemplating the case,
          and it occurred to me that I must see a very curious thing; and it
          angered me extremely, so I told him to stop at the door. What kind of
          man is this? In all probability he would not accept anything of value.
          When he walked up into the room, he asked me to take him out. I made
          him stop and walk back, took him by the hand &mdash; there was no
          stopping him.’
        </div>
        <audio src="audio/spleen.mp3" controls></audio>
        <div class="chunk-text">Or this, which I love:</div>

        <div class="quote-text">
          'It is not that we are away,' said Stephen, 'but we were out of our
          minds, and I have been thinking. If you are an odd kind of ape, with
          your strange ideas of the past and future, the present is in the past
          -- in the past, I mean; and the future is in the past. Think of the
          billowing water-bank: with its pools and its tall grass it would be
          difficult to imagine anything more than this distant bird, an elegant
          creature that lives in solitary splendour, feeding all its young: all
          the more so, because as for the present, the grass has been entirely
          taken from us. It has already vanished. How I regret the loss of a
          moment.' He held up his hand and cried, 'A little brush with a brush
          would help. It would be a cruel bitter cold; but the day would not
          last.'
        </div>
        <audio src="audio/grass.mp3" controls></audio>
      </div>
      <div class="title">
        3. What about ChatGPT?<span class="material-symbols-sharp expand">
          expand_more
        </span>
      </div>
      <div class="collapse">
        <div class="chunk-text">
          Right. As O'Brain was slowly being created (using an already
          out-of-date model due to limited resources), AI language models
          exploded, and OpenAI's ChatGPT has gone through several iterations.
          ChatGPT is certainly aware of O'Brian, and I would say that his work
          was part of its dataset. <br /><br />Below, you can see some responses
          from ChatGPT4 when asked to generate some O'Brian paragraphs. They are
          more syntactically sensible than O'Brain's results, and, unlike
          O'Brain, the third and fourth sentences are not blissfully unaware of
          the first and second. That said, there is something in the voice that
          is a little wrong. There is a contemporariness; the edges feel sanded
          down, and they both have ChatGPT's chipper outlook.
        </div>
        <div class="quote-text">
          <em
            >Write me a paragraph in the style of Patrick O'Brian about Stephen
            watching the sunrise from the deck of the Sophie while drinking
            coffee.</em
          ><br /><br />
          Here is a paragraph I wrote for you: <br /><br />Stephen Maturin stood
          on the quarterdeck of the Sophie, holding a steaming cup of coffee in
          his hand. He had risen early, as was his habit, to observe the natural
          phenomena of the dawn. He watched with keen interest as the sun
          emerged from the horizon, casting a golden light over the calm sea. He
          admired the delicate hues of the sky, the gentle breeze that stirred
          the sails, and the graceful flight of the gulls. He felt a profound
          sense of peace and wonder, mingled with gratitude for his friend Jack
          Aubrey, who had given him this opportunity to sail and explore. He
          sipped his coffee and smiled, thinking that this was a fine way to
          start the day.<br /><br />
          <em>Can you write another paragraph in the same style?</em
          ><br /><br />
          Sure, here is another paragraph I wrote for you: <br /><br />Jack
          Aubrey came up on deck, rubbing his eyes and yawning. He saw Stephen
          standing by the rail, looking at the sunrise. He joined him and
          greeted him warmly. "Good morning, Doctor. You are up early, as usual.
          How do you find the weather?" He took a sip of coffee from Stephen's
          cup and made a face. "This is vile stuff. How can you drink it?" He
          handed it back to Stephen and looked around. He saw the Sophie's crew
          busy with their morning tasks, the other ships of the squadron in
          sight, and the land of Spain looming ahead. He felt a surge of
          excitement and anticipation. He said to Stephen, "We are in for a fine
          day, my dear. A fine day indeed."
        </div>
      </div>
    </main>
    <footer>
      Other little <a href="https://www.dugward.com">things by dugward</a>.
    </footer>

    <!-- scripties––––––––––––––––––––––––––––––– -->

    <script type="module" src="./js/main.js"></script>
    <script
      data-goatcounter="https://dugward.goatcounter.com/count"
      async
      src="//gc.zgo.at/count.js"
    ></script>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-HC50DNFH4L"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-HC50DNFH4L");
    </script>
  </body>
</html>
